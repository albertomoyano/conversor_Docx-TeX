' Gambas class file

Public Sub Form_Open()

  txtDESTINO.SetFocus()

End

Public Sub btnBuscar_Click()

  Dialog.Title = "Seleccionar archivo"
  Dialog.Filter = ["*.docx", "Archivos de MS Word"]
  Dialog.AutoExt = True
  Dialog.Path = User.Home
  If Dialog.OpenFile() Then
    Return
  Else
    txtORIGEN.Text = Dialog.Path
  Endif

Catch
  Message.Error("No se pudo abrir el archivo")

End

Public Sub btnCONVERTIR_Click()

  Dim escapedPath As String
  Dim destino As String = File.Dir(Dialog.Path) & "/" & txtDESTINO.text & ".tex"

  txtORIGEN.Text = Dialog.Path

  escapedPath = Replace(Dialog.Path, " ", "\\ ") ' Escapa los espacios en blanco en la ruta
  escapedPath = Replace(escapedPath, "'", "'\\''") ' Escapa las comillas simples en la ruta

  Shell "pandoc --wrap=none --extract-media=./ -t latex -f docx " & escapedPath & " -o " & destino

  btnListo.Visible = True
  btnListo.Default = True
  btnSalir.Visible = False
  ' If File.RealPath(destino) Then
  '   lblMENSAJE.Text = "El archivo se ha convertido correctamente."
  ' Else
  '   lblMENSAJE.Text = "Hubo problemas en la conversi√≥n del archivo."
  ' Endif

End

Public Sub Form_Close()

  Me.Close()

End

Public Sub txtDESTINO_KeyPress()

  If Key.Text <> Upper(Key.Text) Then
    txtDESTINO.Insert(Upper(Key.Text))
    Stop Event
  Endif

End

Public Sub btnSalir_Click()

  Me.Close()

End

Public Sub btnListo_Click()

  Me.Close()

End
